# AI 기반 훈련 피드백 설정 가이드

## 개요
도시가스 비상대응 모의훈련 플랫폼에 ChatGPT(OpenAI) 기반 개인화된 피드백 기능이 추가되었습니다.

## 🚀 주요 기능

### 1. AI 기반 개인화 피드백
- **개인별 맞춤 분석**: 훈련생의 점수, 선택한 답변, 소요 시간 등을 종합 분석
- **구체적인 강점 도출**: 우수한 대응 능력과 잘한 부분을 명확히 제시
- **개선 영역 식별**: 부족한 부분과 개선이 필요한 영역을 구체적으로 제시
- **행동 계획 제공**: 실질적인 개선을 위한 구체적인 행동 계획 제안
- **다음 훈련 가이드**: 향후 훈련에서 집중해야 할 영역 권장

### 2. 자동 Fallback 시스템
- AI 서비스 오류 시 기본 피드백으로 자동 전환
- 사용자 경험 중단 없이 안정적인 서비스 제공

## ⚙️ 설정 방법

### 1. OpenAI API 키 발급
1. [OpenAI Platform](https://platform.openai.com/)에 가입
2. API Keys 섹션에서 새 API 키 생성
3. 생성된 API 키 복사 (안전한 곳에 보관)

### 2. 환경변수 설정
프로젝트 루트 디렉토리에 `.env` 파일을 생성하고 다음 내용 추가:

```env
VITE_OPENAI_API_KEY=your_openai_api_key_here
VITE_AI_FEEDBACK_ENABLED=true
```

**⚠️ 중요**: `your_openai_api_key_here`를 실제 발급받은 API 키로 교체하세요.

### 3. 환경변수 예시
```env
VITE_OPENAI_API_KEY=sk-proj-abcd1234efgh5678ijkl9012mnop3456qrst7890uvwx1234yz
VITE_AI_FEEDBACK_ENABLED=true
```

## 🎯 사용 방법

### 1. 훈련 완료 시
- 23단계 훈련 완료 후 자동으로 AI 피드백 생성 시작
- "🤖 AI 피드백 생성 중..." 메시지와 함께 로딩 표시
- 약 10-30초 후 개인화된 피드백 완성

### 2. 생성되는 피드백 항목
```
💪 강점
✅ 우수한 대응
⚠️ 개선 영역
🎯 세부 피드백 (의사결정, 대응시간, 절차준수 등)
📋 개선 행동 계획
🎓 다음 훈련 권장사항
⚡ 자주 발생하는 실수
```

### 3. AI 서비스 상태 확인
- AI 피드백 생성 시 "AI 기반 개인화된 피드백이 생성되었습니다" 표시
- API 키 미설정 또는 오류 시 기본 피드백으로 자동 전환

## 🔧 기술 사양

### 사용 AI 모델
- **모델**: GPT-4o-mini (비용 효율적)
- **최대 토큰**: 1,500
- **Temperature**: 0.7 (창의적이면서도 일관성 있는 응답)

### API 호출 구조
```javascript
// 훈련 데이터 → AI 분석 → 구조화된 피드백
{
  "overallAssessment": "전반적인 성과 평가",
  "strengths": ["강점 1", "강점 2", ...],
  "improvementAreas": ["개선점 1", "개선점 2", ...],
  "specificFeedback": [
    {
      "category": "의사결정",
      "feedback": "구체적인 피드백"
    }
  ],
  "actionPlan": ["행동계획 1", "행동계획 2", ...],
  "nextTrainingRecommendations": ["권장사항 1", "권장사항 2", ...]
}
```

## 💰 비용 관리

### 예상 비용 (GPT-4o-mini 기준)
- **훈련 1회당**: 약 $0.01-0.02 (10-20원)
- **월 100회 훈련**: 약 $1-2 (1,000-2,000원)
- **효율적인 모델 사용**: GPT-4 대비 20배 저렴

### 비용 최적화 팁
1. `VITE_AI_FEEDBACK_ENABLED=false`로 설정하여 필요시에만 활성화
2. API 키의 사용량 한도 설정
3. OpenAI 대시보드에서 사용량 모니터링

## 🛠️ 문제 해결

### API 키 관련 오류
```javascript
// 콘솔에서 확인할 수 있는 메시지들
"AI 서비스가 설정되지 않았습니다. 기본 피드백을 사용합니다."
"AI API 요청 실패: 401 Unauthorized"
```

**해결 방법**:
1. `.env` 파일의 API 키 확인
2. API 키의 유효성 및 잔액 확인
3. 브라우저 새로고침 (환경변수 재로딩)

### 응답 속도가 느린 경우
- 정상 범위: 10-30초
- 30초 이상 지연 시 네트워크 상태 확인
- 오류 발생 시 자동으로 기본 피드백으로 전환

### AI 피드백이 표시되지 않는 경우
1. 콘솔에서 오류 메시지 확인
2. 환경변수 설정 재확인
3. 기본 피드백으로 정상 동작하는지 확인

## 🔒 보안 주의사항

### API 키 보안
- **절대 공개하지 마세요**: GitHub, 공개 저장소에 업로드 금지
- **환경변수 사용**: 코드에 직접 하드코딩 금지
- **주기적 교체**: 보안을 위해 정기적으로 API 키 교체

### .env 파일 관리
```bash
# .gitignore에 추가되어 있는지 확인
.env
.env.local
.env.production
```

## 📞 지원

### 문제 발생 시
1. 브라우저 개발자 도구 콘솔 확인
2. 오류 메시지 스크린샷 준비
3. 환경 설정 정보 확인

### 기능 개선 요청
- AI 피드백 품질 개선
- 추가 분석 항목 요청
- 새로운 피드백 카테고리 제안

---

**🎉 이제 AI 기반 개인화된 훈련 피드백을 활용하여 더욱 효과적인 비상대응 훈련을 진행하세요!**
